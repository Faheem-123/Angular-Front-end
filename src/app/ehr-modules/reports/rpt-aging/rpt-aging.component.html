<div class="d-flex flex-column flex-grow-1 mt-0 position-relative">


  <div class="d-flex flex-column flex-grow-1 border-content-box border-top-0 light-sky-blue">
    <!-- ************************************************************** -->

    <div class="encounter-data-accordian accordian-data accordian-search rounded-0 border-bottom border-top-0">
      <div class="accordian-header" role="tab" id="headingOne">
        <h5 class="mb-0">
          <a data-toggle="collapse" href="#SearchCriteriaAgingRpt" aria-expanded="true"
            class="accordian-link rounded-0">
            <span class="accordian-main-header-title pl-1 pr-1"> Search Criteria</span>
          </a>
        </h5>
      </div>
      <div id="SearchCriteriaAgingRpt" class="show">
        <div class="accordian-body bg-transparent">


          <form [formGroup]="searchForm">
            <div class="p-2 pt-0">

              <div class="form-row form-dashboard">
                <div class="form-group col-4">
                  <div class="btn-group radio-btn-tabs ">

                    <label class="btn btn-secondary" [ngClass]="{'active' : (dateType === 'date_created')}">
                      <input type="radio" name="dateType" autocomplete="off" checked formControlName="dateType"
                        value="date_created" (ngModelChange)="onDateTypeChange($event)"> Date Created
                    </label>
                    <label class="btn btn-secondary" [ngClass]="{'active' : (dateType === 'dos')}">
                      <input type="radio" name="dateType" autocomplete="off" checked formControlName="dateType"
                        value="dos" (ngModelChange)="onDateTypeChange($event)"> DOS
                    </label>
                    <label class="btn btn-secondary" [ngClass]="{'active' : (dateType === 'date_billed')}">
                      <input type="radio" name="dateType" autocomplete="off" checked formControlName="dateType"
                        value="date_billed" (ngModelChange)="onDateTypeChange($event)"> Date Billed
                    </label>
                  </div>

                  <div class="d-flex flex-grow-3">

                    <div class="input-group mr-1">

                      <div class="input-group-prepend">
                        <span class="input-group-text">From</span>
                      </div>

                      <input id="dpfromDate" formControlName="dpfromDate" class="form-control date-control "
                        placeholder="mm/dd/yyyy" firstDayOfWeek="7" name="dpfromDate" ngbDatepicker #dpfromDate="ngbDatepicker">

                      <span class="input-group-btn">
                        <button class="btn date-control-btn" (click)="dpfromDate.toggle()" type="button"
                          focusable="false" tabindex="-1">
                        </button>
                      </span>

                    </div>

                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text">To</span>
                      </div>

                      <input id="dptoDate" formControlName="dptoDate" class="form-control date-control "
                        placeholder="mm/dd/yyyy" firstDayOfWeek="7" name="dptoDate" ngbDatepicker #dptoDate="ngbDatepicker">

                      <span class="input-group-btn">
                        <button class="btn date-control-btn" (click)="dptoDate.toggle()" type="button"
                          focusable="false" tabindex="-1">
                        </button>
                      </span>

                    </div>


                  </div>
                </div>

                <div class="form-group col-3">
                  <label class="col-form-label" for="drpLocation">Location</label>

                  <select class="form-control " labelForId="drpLocation" formControlName="drpLocation">
                    <option value=''>All</option>
                    <option *ngFor="let loc of lookupList.locationList" [value]="loc.id">{{loc.name}}</option>
                  </select>

                </div>

                <div class="form-group col-3">
                  <label class="col-form-label" for="drpProvider">Provider</label>

                  <select class="form-control " labelForId="drpProvider" formControlName="drpProvider">
                    <option value=''>All</option>
                    <option *ngFor="let prov of lookupList.providerList" [value]="prov.id">{{prov.name}}
                    </option>
                  </select>
                </div>
                <div class="form-group col-2">
                  <label class="col-form-label" for="drpClaimType">Claim Type</label>

                  <select class="form-control" id="drpClaimType" formControlName="drpClaimType">
                    <option value="all">All</option>
                    <option value="office">Office Claim</option>
                    <option value="lab">Lab Claim</option>
                  </select>
                </div>

              </div>
              <div class="form-row form-dashboard">

                <div class="form-group col-2">
                  <label class="col-form-label" for="drpPriStatus">Pri. Status</label>

                  <select class="form-control" id="drpPriStatus" formControlName="drpPriStatus">
                    <option value=""></option>
                    <option value="all">All</option>
                    <option value="Billed">Billed</option>
                    <option value="Paid">Paid</option>
                    <option value="Partially Paid">Partially Paid</option>
                  </select>

                </div>
                <div class="form-group col-2">
                  <label class="col-form-label" for="drpSecStatus">Sec. Status</label>

                  <select class="form-control" id="drpSecStatus" formControlName="drpSecStatus">
                    <option value=""></option>
                    <option value="all">All</option>
                    <option value="Billed">Billed</option>
                    <option value="Paid">Paid</option>
                    <option value="Partially Paid">Partially Paid</option>
                  </select>

                </div>
                
                <div class="form-group col-4">
                  <div class="btn-group radio-btn-tabs ">

                    <label class="btn btn-secondary" [ngClass]="{'active' : (payerType === 'all_payers')}">
                      <input type="radio" name="payerType" autocomplete="off" checked formControlName="payerType"
                        value="all_payers" (ngModelChange)="onPayerTypeChange($event)"> Payer (All)
                    </label>
                    <label class="btn btn-secondary" [ngClass]="{'active' : (payerType === 'pri_payer')}">
                      <input type="radio" name="payerType" autocomplete="off" checked formControlName="payerType"
                        value="pri_payer" (ngModelChange)="onPayerTypeChange($event)"> Pri. Payer
                    </label>
                    <label class="btn btn-secondary" [ngClass]="{'active' : (payerType === 'sec_payer')}">
                      <input type="radio" name="payerType" autocomplete="off" checked formControlName="payerType"
                        value="sec_payer" (ngModelChange)="onPayerTypeChange($event)"> Sec. Payer
                    </label>
                    <label class="btn btn-secondary" [ngClass]="{'active' : (payerType === 'oth_payer')}">
                      <input type="radio" name="payerType" autocomplete="off" checked formControlName="payerType"
                        value="oth_payer" (ngModelChange)="onPayerTypeChange($event)"> Oth. Payer
                    </label>
                  </div>



                  <div class="d-flex flex-grow-3">

                    <div class="input-group mr-1">

                      <div class="input-group-prepend">
                        <span class="input-group-text">Payer</span>
                      </div>

                      <div class="form-group col px-0 mb-0">
                        <div class="input-icon d-flex flex-grow-3">
                          <input id="txtpayerSearch" class="form-control flex-grow-3 " type="text"
                            placeholder="Search Payer" (keydown)="onPayerSearchKeydown($event)"
                            (blur)="onPayerSearchBlur()" autocomplete="off" #txtpayerSearch
                            formControlName="txtpayerSearch">
                          <div class="icon">
                            <i class="fa fa-search" aria-hidden="true"></i>
                          </div>
                          <inline-payer-search *ngIf="showPayerSearch" [calling_from]="aging"
                            [searchValue]="txtpayerSearch.value" (onPayerSelect)="openSelectPayer($event)"
                            (onClose)="closePayerSearch()" style="top:25px;right:450px;" class="position-absolute">
                          </inline-payer-search>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>

               

                <div class="form-group col-3">
                  <label for="txtPatientSearch" class="col-form-label">Patient</label>

                  <div class="input-icon d-flex flex-grow-3">
                    <input labelForId="txtPatientSearch" class="form-control flex-grow-3 " type="text" #txtPatientSearch
                      placeholder="Search Patient" (keydown)="onPatientSearchKeydown($event)" autocomplete="off"
                      (blur)="onPatientSearchBlur()" formControlName="txtPatientSearch">
                    <div class="icon">
                      <i class="fa fa-search" aria-hidden="true"></i>
                    </div>
                    <inline-patient-search *ngIf="showPatientSearch" [searchValue]="txtPatientSearch.value"
                      (onPatientSelect)="openSelectPatient($event)" (onClose)="closePatientSearch()"
                      style="top:25px;right:450px;" class="position-absolute">
                    </inline-patient-search>
                  </div>

                </div>

                <div class="form-group col-2">
                  <label class="col-form-label max-width-100">Amt Due:</label>
                  <div class="input-group">

                    <select class="form-control" formControlName="drpAmtCond">
                      <option *ngFor="let a of lstAmtCnd" [value]="a">{{a}}</option>
                    </select>
                    <input class="form-control" type="text" formControlName="txtAmount">
                  </div>
                </div>

                <div class=" col-2">
                  <label class="col-form-label" for="drpClaimType">Claim Type</label>

                  <div class="custom-control custom-checkbox green-checkbox pl-1">
                    <input type="checkbox" class="custom-control-input" id="chkAgingSelfPatientBilled"
                      formControlName="chkAging_Self">
                    <label class="custom-control-label" for="chkAgingSelfPatientBilled">Self/ Patient Billed</label>
                  </div>
                </div>

                <div class="form-group col-1 d-flex justify-content-end align-items-end">
                  <button type="button" ng-disabled="btnHide" class="btn btn-success" [disabled]="isLoading"
                    (click)="onSearch(searchForm.value)">Search</button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- ************************************************************** -->
    <div class="border d-flex flex-column flex-grow-1 max-height-100">
      <div class="d-flex align-items-center justify-content-between flex-shrink-0">
        <h4 class="form-edit-sub-heading border-bottom-0 m-1 mb-0 pl-1">Details
          <span *ngIf="lstClaimDetails!=undefined" class="fz-12">({{lstClaimDetails.length}})</span>
        </h4>
        <div class="d-flex align-items-center justify-content-end flex-shrink-0">
          <button type="button" class="btn btn-link fz-13 px-2 py-0 mr-1"
            (click)="showDetailView()">{{btnDetailView}}</button>
          <button class="btn btn-link fz-12 title-bar-blue-btn font-weight-400 py-0" (click)="exportAsXLSX()"><i
              class="fas fa-file-excel fa-md text-ihc-blue mr-1"></i> Export</button>
        </div>
      </div>

      <div class="overflow-auto flex-grow-1  overflow-height">
        <table class="table light-striped-border">
          <thead>
            <tr>
              <th scope="col" sortable="dos" type="datetime" formate="MM/DD/YYYY" (sort)="onSort($event)">DOS</th>
              <th scope="col" sortable="alternate_account" type="numeric" (sort)="onSort($event)">PID</th>
              <th scope="col" sortable="patient_name" type="alpha" (sort)="onSort($event)">Patient Name</th>
              <th scope="col" sortable="dob" type="datetime" formate="MM/DD/YYYY" (sort)="onSort($event)">DOB</th>

              <th scope="col" sortable="attending_physician" type="alpha" (sort)="onSort($event)">Attending Physician
              </th>
              <th scope="col" sortable="location_name" type="alpha" (sort)="onSort($event)">Location</th>

              <th *ngIf="detailView" scope="col" sortable="pri_status" type="alpha" (sort)="onSort($event)">Pri. Status
              </th>
              <th *ngIf="detailView" scope="col" sortable="sec_status" type="alpha" (sort)="onSort($event)">Sec. Status
              </th>
              <th *ngIf="detailView" scope="col" sortable="oth_status" type="alpha" (sort)="onSort($event)">Oth. Status
              </th>
              <th *ngIf="detailView" scope="col" sortable="pat_status" type="alpha" (sort)="onSort($event)">Pat. Status
              </th>

              <th scope="col" sortable="primary_insurance" type="alpha" (sort)="onSort($event)">Primary Insurance</th>
              <th scope="col" sortable="secondary_insurance" type="alpha" (sort)="onSort($event)">Secondary Insurance
              </th>


              <th *ngIf="detailView" scope="col" sortable="elig_status_primary" type="alpha" (sort)="onSort($event)">
                Pri. Eligibility</th>
              <th *ngIf="detailView" scope="col" sortable="elig_status_secondary" type="alpha" (sort)="onSort($event)">
                Sec. Eligibility</th>
              <th *ngIf="detailView" scope="col" sortable="coding_done_date" type="datetime" formate="MM/DD/YYYY"
                (sort)="onSort($event)">Coding Done Date</th>
              <th *ngIf="detailView" scope="col" sortable="submission_date" type="datetime" formate="MM/DD/YYYY"
                (sort)="onSort($event)">Submission Date</th>
              <th *ngIf="detailView" scope="col" sortable="batch_generated_date" type="datetime" formate="MM/DD/YYYY"
                (sort)="onSort($event)">Batch Date</th>
              <th *ngIf="detailView" scope="col" sortable="last_claim_note_date" type="datetime" formate="MM/DD/YYYY"
                (sort)="onSort($event)">Last Note Date</th>

              <th *ngIf="detailView" scope="col" sortable="pri_paid" type="alpha" (sort)="onSort($event)">Pri. Paid</th>
              <th *ngIf="detailView" scope="col" sortable="sec_paid" type="alpha" (sort)="onSort($event)">Sec. Paid</th>
              <th *ngIf="detailView" scope="col" sortable="oth_paid" type="alpha" (sort)="onSort($event)">Oth. Paid</th>
              <th *ngIf="detailView" scope="col" sortable="patient_paid" type="alpha" (sort)="onSort($event)">Pat. Paid
              </th>

              <th *ngIf="detailView" scope="col" sortable="write_off" type="numeric" (sort)="onSort($event)">Write Off
              </th>
              <th *ngIf="detailView" scope="col" sortable="discount" type="numeric" (sort)="onSort($event)">Discount
                Amt.</th>
              <th *ngIf="detailView" scope="col" sortable="risk_amount" type="numeric" (sort)="onSort($event)">Risk Amt.
              </th>
              <th *ngIf="detailView" scope="col" sortable="adjust_amount" type="numeric" (sort)="onSort($event)">Adjust
                Amt.</th>

              <th *ngIf="detailView" scope="col" sortable="claim_total" type="numeric" (sort)="onSort($event)">Total
                Charges</th>
              <th scope="col" sortable="amt_due" type="numeric" (sort)="onSort($event)">Due Amout</th>
              <th *ngIf="detailView" scope="col" sortable="patient_statement_dates" type="datetime" formate="MM/DD/YYYY"
                (sort)="onSort($event)">Patient Statement Dates</th>

              <th scope="col" sortable="aging_30" type="numeric" (sort)="onSort($event)">Aging 30</th>
              <th scope="col" sortable="aging_60" type="numeric" (sort)="onSort($event)">Aging 60</th>
              <th scope="col" sortable="aging_90" type="numeric" (sort)="onSort($event)">Aging 90</th>
              <th scope="col" sortable="aging_120" type="numeric" (sort)="onSort($event)">Aging 120</th>
              <th scope="col" sortable="aging_120_plus" type="numeric" (sort)="onSort($event)">Aging 120+</th>

              <th scope="col" sortable="no_of_days_pri" type="numeric" (sort)="onSort($event)">Pri. Filing Limit</th>
              <th scope="col" sortable="no_of_days_sec" type="numeric" (sort)="onSort($event)">Sec. Filing Limit</th>
              <th scope="col" sortable="no_of_days_oth" type="numeric" (sort)="onSort($event)">Oth. Filing Limit</th>
              <!-- <th *ngIf="detailView">Last Note</th> -->
            </tr>
          </thead>
          <tbody>
            <tr st-select-row="row" *ngFor="let eleg of lstClaimDetails; let i=index" (click)="onSelectionChange(i)"
              [ngClass]="{'active': i==selectedRow}">
              <td>
                <button type="button" class="link-btn" (click)="openClaim(eleg)">{{eleg.dos}}</button>
              </td>
              <td>{{eleg.alternate_account}}</td>
              <td>
                <button type="button" class="link-btn" (click)="openPatient(eleg)">{{eleg.patient_name}}</button>
              </td>
              <td>{{eleg.dob}}</td>

              <td>{{eleg.attending_physician}}</td>
              <td>{{eleg.location_name}}</td>

              <td *ngIf="detailView">{{eleg.pri_status}}</td>
              <td *ngIf="detailView">{{eleg.sec_status}}</td>
              <td *ngIf="detailView">{{eleg.oth_status}}</td>
              <td *ngIf="detailView">{{eleg.pat_status}}</td>

              <td>{{eleg.primary_insurance}}</td>
              <td>{{eleg.secondary_insurance}}</td>
              <!-- <td>{{eleg.other_insurance}}</td> -->
              <td *ngIf="detailView">{{eleg.elig_status_primary}}</td>

              <td *ngIf="detailView">{{eleg.elig_status_secondary}}</td>
              <td *ngIf="detailView">{{eleg.coding_done_date}}</td>
              <td *ngIf="detailView">{{eleg.submission_date}}</td>
              <td *ngIf="detailView">{{eleg.batch_generated_date}}</td>

              <td *ngIf="detailView">{{eleg.last_claim_note_date}}</td>
              <td *ngIf="detailView">{{eleg.pri_paid}}</td>
              <td *ngIf="detailView">{{eleg.sec_paid}}</td>
              <td *ngIf="detailView">{{eleg.oth_paid}}</td>

              <td *ngIf="detailView">{{eleg.patient_paid}}</td>
              <td *ngIf="detailView">{{eleg.write_off}}</td>
              <td *ngIf="detailView">{{eleg.discount}}</td>
              <td *ngIf="detailView">{{eleg.risk_amount}}</td>

              <td *ngIf="detailView">{{eleg.adjust_amount}}</td>
              <td *ngIf="detailView">{{eleg.claim_total}}</td>
              <td>{{eleg.amt_due}}</td>
              <td *ngIf="detailView">{{eleg.patient_statement_dates}}</td>

              <td>{{eleg.aging_30}}</td>
              <td>{{eleg.aging_60}}</td>
              <td>{{eleg.aging_90}}</td>
              <td>{{eleg.aging_120}}</td>
              <td>{{eleg.aging_120_plus}}</td>

              <td>{{eleg.no_of_days_pri}}</td>
              <td>{{eleg.no_of_days_sec}}</td>
              <td>{{eleg.no_of_days_oth}}</td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="border-content-box border-top-0 rounded-bottom flex-shrink-0 overflow-auto bg-white">
    <table class="table light-striped-border">
      <thead>
        <tr>
          <th>Current to 30 days:</th>
          <th>31 to 60 days:</th>
          <th>61 to 90 days:</th>
          <th>91 to 120 days:</th>
          <th>120+ days:</th>
          <th>Total:</th>
        </tr>
      </thead>
      <tbody>
        <tr st-select-row="row">
          <td>{{total_30}}</td>
          <td>{{total_60}}</td>
          <td>{{total_90}}</td>
          <td>{{total_120}}</td>
          <td>{{total_120Plus}}</td>
          <td>{{total_amount}}</td>
        </tr>
      </tbody>
    </table>
  </div>


  <div class="div-ui-blocker" id="uiBlocker" *ngIf="isLoading">
    <div class="div-ui-blocker-message-box ">
      <i class="fas fa-spinner fa-spin mr-1"></i>Loading...
    </div>
  </div>


</div>